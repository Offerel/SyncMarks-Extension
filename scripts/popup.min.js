function cSearch(){document.getElementById("bookmarks").innerHTML=clone.innerHTML}function addClick(){document.querySelectorAll(".file").forEach(function(e){e.addEventListener("mouseup",function(e){window.open(e.target.dataset.url,"_blank","noopener,noreferrer")},!1)})}function urlExists(){chrome.tabs.query({active:!0,currentWindow:!0},function(e){let t=e[0].url,n=!1,o=document.querySelectorAll(".file");for(let e=0;e<o.length;e++)if(bmURL=o[e].children[0].dataset.url,t===bmURL){n=!0;break}n?(document.getElementById("svgfilled").style.display="inline",document.getElementById("svgoutline").style.display="none"):(document.getElementById("svgfilled").style.display="none",document.getElementById("svgoutline").style.display="inline")})}var clone;document.addEventListener("DOMContentLoaded",function(e){chrome.storage.local.get(null,function(e){let t={};t.client=e.uuid,t.token=e.token;let n="Bearer "+btoa(encodeURIComponent(JSON.stringify(t)));fetch(e.instance+"?t="+Math.random().toString(24).substring(2,12),{method:"GET",cache:"no-cache",referrerPolicy:"no-referrer",headers:{Authorization:n}}).then(e=>{let t=e.headers.get("X-Request-Info");return null!=t&&(0==t?(chrome.storage.local.remove("token"),chrome.runtime.sendMessage({action:"changeIcon",data:"error"}),console.error("token removed")):chrome.storage.local.set({token:t})),e.text()}).then(e=>{let t=new DOMParser,n=t.parseFromString(e,"text/html");document.getElementById("bookmarks").innerHTML=n.getElementById("bookmarks").innerHTML,addClick(),urlExists(),clone=document.getElementById("bookmarks").cloneNode(!0)}).catch(e=>{console.error(e),chrome.runtime.sendMessage({action:"changeIcon",data:"error"})})}),search=document.getElementById("search"),document.getElementById("settings").addEventListener("click",e=>{chrome.runtime.openOptionsPage()}),document.getElementById("addbm").addEventListener("click",e=>{chrome.runtime.sendMessage({action:"bookmarkTab"}),window.close()})}),search.addEventListener("input",function(e){let t=e.currentTarget.value,n=document.querySelectorAll("#bookmarks li.file"),o=document.getElementById("bookmarks");""===e.currentTarget.value?(cSearch(),addClick()):(o.innerHTML="",n.forEach(e=>{o.appendChild(e),e.innerText.toUpperCase().includes(t.toUpperCase())||e.firstChild.dataset.url.toUpperCase().includes(t.toUpperCase())?(e.style.display="block",e.style.paddingLeft="20px"):e.style.display="none"}))});